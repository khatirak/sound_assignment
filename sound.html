<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basketball Arena</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-item">Home</a>
            <a href="sound.html" class="nav-item active">Sound</a>
            <a href="bts.html" class="nav-item">BTS</a>
            <a href="about.html" class="nav-item">About</a>
        </div>
    </nav>

    <div class="arena-container">
        <!-- Crowd area with people icons -->
        <div class="crowd-area" id="crowdArea">
            <!-- Crowd people icons will be generated by JavaScript -->
            
            <!-- Hover instruction note -->
            <div class="hover-instruction" id="hoverInstruction">
                <p>ðŸ’¬ Hover over the crowd to hear reactions</p>
            </div>
            
            <!-- Speech bubbles for each section -->
            <div class="speech-bubble speech-bubble-1" id="speechBubble1">
                <img src="img/speech1.png" alt="Speech bubble 1">
            </div>
            <div class="speech-bubble speech-bubble-2" id="speechBubble2">
                <img src="img/speech2.png" alt="Speech bubble 2">
            </div>
            <div class="speech-bubble speech-bubble-3" id="speechBubble3">
                <img src="img/speech3.png" alt="Speech bubble 3">
            </div>
        </div>

        <!-- Hoop pole (outside court, extends upward) -->
        <div class="hoop-pole"></div>

        <!-- Basketball court -->
        <div class="court">
            <!-- Sidelines extending full court -->
            <div class="sideline-left"></div>
            <div class="sideline-right"></div>
            
            <!-- Court markings - Far side (top) -->
            <div class="lane-left-far"></div>
            <div class="lane-right-far"></div>
            <div class="free-throw-line-far"></div>
            <div class="free-throw-circle-far"></div>
            <div class="three-point-line-far"></div>

            <!-- Basketball -->
            <div class="basketball"></div>
        </div>

        <!-- Backboard (outside court, extends upward) -->
        <div class="backboard"></div>
        
        <!-- Hoop (outside court, extends upward) -->
        <div class="hoop"></div>

      
    </div>

    <!-- Choice Buttons Container -->
    <div class="choice-buttons-container">
        <!-- Play Button -->
        <div id="playButton" class="play-button-container">
            <button onclick="startAudio()" class="play-btn">â–¶ Play</button>
        </div>

        <!-- First Choice Buttons -->
        <div id="firstChoiceButtons" class="choice-buttons" style="display: none;">
            <h2>First Shot: What happened?</h2>
            <div class="button-group">
                <button onclick="handleFirstChoice('make')" class="choice-btn">Make</button>
                <button onclick="handleFirstChoice('miss')" class="choice-btn">Miss</button>
            </div>
        </div>

        <!-- Second Choice Buttons -->
        <div id="secondChoiceButtons" class="choice-buttons" style="display: none;">
            <h2>Second Shot: What happened?</h2>
            <div class="button-group">
                <button onclick="handleSecondChoice('make')" class="choice-btn">Make</button>
                <button onclick="handleSecondChoice('miss')" class="choice-btn">Miss</button>
            </div>
        </div>
    </div>

    <script>
        // Generate crowd SVG people icons in organized rows
        const crowdArea = document.getElementById('crowdArea');
        const rows = 5;
        const iconsPerRow = 15;
        const iconSize = 60;
        const spacing = 2;
        
        let iconIndex = 0;
        
        // People SVG icon - two people together
        const peopleSVG = `
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <!-- Person 1 (left) -->
                <circle cx="7" cy="6" r="2.5" fill="currentColor"/>
                <path d="M7 10c-2.2 0-4 1.8-4 4v3h8v-3c0-2.2-1.8-4-4-4z" fill="currentColor"/>
                <!-- Person 2 (right) -->
                <circle cx="17" cy="6" r="2.5" fill="currentColor"/>
                <path d="M17 10c-2.2 0-4 1.8-4 4v3h8v-3c0-2.2-1.8-4-4-4z" fill="currentColor"/>
            </svg>
        `;
        
        // Create audio objects for comment files
        const commentAudios = {
            comment1: new Audio('sound/comment1.WAV'),
            comment2: new Audio('sound/comment2.WAV'),
            comment3: new Audio('sound/comment3.WAV')
        };
        
        // Track which audio is currently playing
        let currentHoverAudio = null;
        
        // Function to determine comment region based on position
        function getCommentRegion(iconElement) {
            const rect = iconElement.getBoundingClientRect();
            const crowdAreaRect = crowdArea.getBoundingClientRect();
            const iconCenterX = rect.left + (rect.width / 2) - crowdAreaRect.left;
            const crowdAreaWidth = crowdAreaRect.width;
            const regionWidth = crowdAreaWidth / 3;
            
            if (iconCenterX < regionWidth) {
                return 'comment1'; // Left region
            } else if (iconCenterX < regionWidth * 2) {
                return 'comment2'; // Center region
            } else {
                return 'comment3'; // Right region
            }
        }
        
        for (let row = 0; row < rows; row++) {
            const numIconsInRow = iconsPerRow + Math.floor(row * 1.5);
            const rowTop = 15 + (row * (iconSize + spacing));
            
            for (let col = 0; col < numIconsInRow; col++) {
                const iconWrapper = document.createElement('div');
                iconWrapper.className = 'crowd-icon';
                iconWrapper.dataset.index = iconIndex++;
                
                // Calculate position
                const totalWidth = numIconsInRow * (iconSize + spacing);
                const startX = (crowdArea.offsetWidth - totalWidth) / 2;
                const left = startX + (col * (iconSize + spacing));
                
                iconWrapper.style.left = left + 'px';
                iconWrapper.style.top = rowTop + 'px';
                
                // Add hover event listeners
                iconWrapper.addEventListener('mouseenter', function() {
                    // Hide instruction on first interaction
                    hideInstruction();
                    
                    // Stop any currently playing hover audio
                    if (currentHoverAudio) {
                        currentHoverAudio.pause();
                        currentHoverAudio.currentTime = 0;
                        // Hide previous speech bubble
                        hideSpeechBubble();
                    }
                    
                    // Determine which comment to play based on icon position
                    const commentRegion = getCommentRegion(iconWrapper);
                    
                    // Show corresponding speech bubble
                    showSpeechBubble(commentRegion);
                    
                    // Play the appropriate comment audio
                    currentHoverAudio = commentAudios[commentRegion];
                    currentHoverAudio.play();
                });
                
                iconWrapper.addEventListener('mouseleave', function() {
                    // Stop the audio when mouse leaves
                    if (currentHoverAudio) {
                        currentHoverAudio.pause();
                        currentHoverAudio.currentTime = 0;
                        currentHoverAudio = null;
                    }
                    // Hide speech bubble when audio stops
                    hideSpeechBubble();
                });
                
                // Add SVG content
                iconWrapper.innerHTML = peopleSVG;
                
                // Add cursor pointer to indicate interactivity
                iconWrapper.style.cursor = 'pointer';
                
                crowdArea.appendChild(iconWrapper);
            }
        }

        // Initialize colors after icons are created
        setTimeout(() => {
            if (typeof updateCrowdColors === 'function') {
                updateCrowdColors('idle');
            }
        }, 100);
        
        // Function to show speech bubble based on comment region
        function showSpeechBubble(commentRegion) {
            // Hide all speech bubbles first
            hideSpeechBubble();
            
            // Show the corresponding speech bubble
            const bubbleId = 'speechBubble' + commentRegion.replace('comment', '');
            const bubble = document.getElementById(bubbleId);
            if (bubble) {
                bubble.classList.add('show');
            }
        }
        
        // Function to hide all speech bubbles
        function hideSpeechBubble() {
            const bubbles = document.querySelectorAll('.speech-bubble');
            bubbles.forEach(bubble => {
                bubble.classList.remove('show');
            });
        }
        
        // Function to hide instruction note
        function hideInstruction() {
            const instruction = document.getElementById('hoverInstruction');
            if (instruction) {
                instruction.classList.add('hidden');
            }
        }
        
        // Hide speech bubbles when audio ends
        Object.values(commentAudios).forEach(audio => {
            audio.addEventListener('ended', function() {
                hideSpeechBubble();
            });
        });
    </script>
    
    <!-- Include the interactive audio script -->
    <script src="script.js"></script>
</body>
</html>